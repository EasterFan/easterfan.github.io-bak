---
title: 我想换个手机：D
tags: 集搜客 BI xwan
---

> 众里寻他千百度


![2018-06-30-gseeker-content-reflect1](/assets/img/blog/logo/2018-06-30-i-want-a-phone.jpg)
<!--more-->

## 一. 写在前面

### 目标配置
参考我的老年机使用经验,以下为最低配置  

|键        |值              |
|---------|---------------|
|运行内存     |4G             |
|手机存储     |64G            |
|Android版本|>6.0           |
|处理器      |四核1.2GHz       |
|分辨率      |720 x 1280(非必要)|
|系统版本号      | EMUI 3.0.1|

于是在京东上看中了两款: [荣耀10](https://item.jd.com/7081550.html) 和 [小米MIX2](https://item.jd.com/5001209.html)

荣耀10有33万商品评价, 小米26万, 好评度都是 98%, 为了更好的比较两款手机, 我决定从中差评入手...  
不过由于京东对评论的限制,最多只能翻 100 页, 即中差评各自最多只能采集 1000 条...  

### 采集思路
通过观察京东商品详情页的 URL , `https://item.jd.com/7081550.html#none` 发现好评/中评/差评页面链接相同,   
即不可以直接采集中评页的数据, 需要从详情页 `https://item.jd.com/7081550.html` 通过一次点击跳转到中评页面,   
所以整个抓取过程分为 **两级**,   
第一级在详情页通过一次**模拟点击**跳转到中评页,   
第二级在中评页面抓取评论内容和评论时间.  

## 二. 制作采集规则(荣耀10中评为例)
### 第一层模拟点击规则:  

#### 1. 规则命名  
打开 DS 谋数台, 输入荣耀10商品详情页地址,命名后查重, 这里我命名为 `换手机 -jd-商品中评1`  
![2018-06-30-gseeker-name-a-rule1](/assets/img/blog/2018/2018-06-30-gseeker-name-a-rule1.png)

#### 2. 新建整理箱 + 内容映射
其实模拟点击是为了定位, 可以不采集数据, 但是为了保证页面加载完全, 我们还是选择抓取一些任意的测试数据, 比如商品名称

![2018-06-30-gseeker-get-phone-name1](/assets/img/blog/2018/2018-06-30-gseeker-get-phone-name1.png)

#### 3. 模拟点击(翻页)
因为默认显示的是综合评论, 我们需要手动点击 **中评** 标签,才能跳转到中评页面,  

翻页步骤主要做的是设置 **翻页区(块级元素)** 和 **翻页标记(文本元素)**  

设置翻页区:  
![2018-06-30-gseeker-fan-ye-mo-ni](/assets/img/blog/2018/2018-06-30-gseeker-fan-ye-mo-ni.png)  

设置翻页标记:  
![2018-06-30-gseeker-fan-ye-mo-ni2](/assets/img/blog/2018/2018-06-30-gseeker-fan-ye-mo-ni2.png)

至此, 第一级模拟点击规则就制作完成了(一定要点击右上角**存规则**),  
爬虫加载完目标页面后,不会马上爬取数据, 而是模仿用户行为, 在网页上点击 `中评` 标签, 然后跳转到中评页面, 执行二级规则准备抓取.  

接下来, 制作二级规则.

### 第二层数据采集规则

1. 去勾选"内容定位"  
2. 点击中评, 跳转到中评页面
3. 勾选"内容定位",并刷新页面结构

#### 1. 规则命名

定位到中评页面后,在主题名栏处输入自定义的主题名，这里我命名为“换手机-jd-商品中评2”，然后查重  

![2018-06-30-gseeker-name-a-rule](/assets/img/blog/2018/2018-06-30-gseeker-name-a-rule.png)  

### 2. 新建整理箱
1. 新建整理箱--这里我命名为"列表"
2. 右击"列表>包容",建立 "评论内容" 和 "评论日期"

![2018-06-30-gseeker-new-a-box](/assets/img/blog/2018/2018-06-30-gseeker-new-a-box.png)  

### 3. 内容映射

评论内容映射:  
点击评论内容后, 观察 `P 标签`,发现其下的文本内容被 `br标签`隔离开了,所以勾选高级设置中的文本内容, 表示只抓取`P标签`下的文本数据.  

![2018-06-30-gseeker-content-reflect](/assets/img/blog/2018/2018-06-30-gseeker-content-reflect.png)

评论时间映射:   
![2018-06-30-gseeker-content-reflect1](/assets/img/blog/2018/2018-06-30-gseeker-content-reflect1.png)

两条数据映射完成后, 点击测试, 会发现第一条评论和日期已经被抓取下来.  

### 4. 样例复刻
因为每条评论数据的网页格式都是相同的, 所以需要复刻第一条评论的抓取规则, 应用到当前页所有评论上.  

1. 点击整理箱,启用样例复刻  
2. 选择第一条评论, 作为样例复刻的第一个节点  
3. 点击第二条评论, 作为样例复刻的第一个节点
4. 点击测试(这时爬取的是当前页面的所有评论)

![2018-06-30-gseekser-copy1](/assets/img/blog/2018/2018-06-30-gseekser-copy1.png)


![2018-06-30-gseeker-copy2](/assets/img/blog/2018/2018-06-30-gseeker-copy2.png)


![2018-06-30-gseeker-copy-test](/assets/img/blog/2018/2018-06-30-gseeker-copy-test.png)

### 5. 记号线索
现在抓取到的只是一个页面, 想要抓取所有分页数据,还需要在分页处做记号索引, 来解决数据抓取的翻页问题  

#### 1. 映射翻页区(DIV块级元素)

![2018-06-30-gseeker-fan-ye1](/assets/img/blog/2018/2018-06-30-gseeker-fan-ye1.png)

#### 2. 映射翻页标记(`#text`元素)
翻页记号映射完后,点击 **存规则** 保存  

![2018-06-30-gseeker-fan-ye2](/assets/img/blog/2018/2018-06-30-gseeker-fan-ye2.png)

#### 3. 填坑
按照上述规则制作完成后, 采集数据时, 发现只有前 10 条评论是中评, 即第一次在中评页面翻页后, 爬虫竟然跳到好评页面, 开始在好评页面翻页, 采集好评.  

这是京东页面结构引起的, 测试了半天才发现有**4个翻页区**，分别对应各种级别的评论，如果不做约束，自动生成的那个翻页用的xpath就会定位到好评.  

![2018-06-30-gseeker-fan-ye-3](/assets/img/blog/2018/2018-06-30-gseeker-fan-ye-3.png)

把生成的xpath用来搜索，能搜到4个。而中评是在comment_4中(差评在comment_5中)。xpath可以手工修改。但是要注意顺序  

1. 自动生成规则以后，点击“存规则”
2. 在上面截图所示的线索规则那里，直接手工修改，修改成
```xml
    //*[@id='comment-4']//*[@class='ui-page']//a[.//text()="下一页"]
```

3. 点击“保存修改”，不能点击“存规则”


注意，下次再点击“存规则”的话，又会被自动生成的规则冲掉，需要再次手工修改，然后用“保存修改”


## 三. 数据采集
1. 打开 DS打数机,
2. 点击规则后的**单搜**, 开始采集  

![2018-06-30-gseeker-data-result1](/assets/img/blog/2018/2018-06-30-gseeker-data-result1.png)

最后数据存放目录为`C:\Users\easter4\DataScraperWorks`  
至此, 采集的是荣耀 10 的前1000条中评评论, 参照中评规则, 制作差评规则.  
采集完荣耀10的评论后, 将小米MIX2的链接作为线索, 加入到中评和差评的规则中,采集小米MIX2的中差评.  

## 四. 数据格式化
可以看到, 采集的数据是很多 xml 数据, 为了方便后续分析, 需要将数据格式统一转成 txt(Excel宏 或 [集搜客自带转化工具](https://www.gooseeker.com/doc/article-329-1.html)),集搜客自带转换方便, 但是只能导入集搜客抓取的数据, 大小也有限制, excel宏就比较自由.  

### 使用excel宏转换
1. 通过Excel宏导入，下载XML转换EXCEL宏，然后将宏文件放在结果文件夹中。
2. 打开宏文件，点击“启用内容”。
3. 点击“视图”选项卡，选择“宏”，在弹出的宏窗口点击“执行”。
4. 将需要分析的内容列存储到一个txt文件中。

![2018-06-30-gseeker-gather-to-txt](/assets/img/blog/2018/2018-06-30-gseeker-gather-to-txt.png)


## 五. 数据预处理
> 由于评论有大量重复，为了使得数据有较大的有效性，对数据进行去重，重复的评论只保留一条。另外评论中有很多网络用语不符合中文语法词法规范的，所以把数据中的英文等其他字符去除。

使用 ROST CM6:  
![2018-06-30-gseeker-data-pre-clean](/assets/img/blog/2018/2018-06-30-gseeker-data-pre-clean.png)


## 六. 分词处理


![2018-06-30-gseeker-data-fen-ci](/assets/img/blog/2018/2018-06-30-gseeker-data-fen-ci.png)

## 七. 数据分析
### 1. 词频分析
![2018-06-30-gseeker-data-ci-pin-operate](/assets/img/blog/2018/2018-06-30-gseeker-data-ci-pin-operate.png)   

荣耀10词频统计:  
![2018-06-30-gseeker-data-ci-pin-rongyao](/assets/img/blog/2018/2018-06-30-gseeker-data-ci-pin-rongyao.png)

小米MIX2词频统计:  
![2018-06-30-gseeker-data-ci-pin-xiao-mi](/assets/img/blog/2018/2018-06-30-gseeker-data-ci-pin-xiao-mi.png)

### 2. 情感分析
荣耀10情感分析:  
![2018-06-30-gseeker-data-motion-rongyao](/assets/img/blog/2018/2018-06-30-gseeker-data-motion-rongyao.png)

小米mix2情感分析:  
![2018-06-30-gseeker-data-motion-xiaomi](/assets/img/blog/2018/2018-06-30-gseeker-data-motion-xiaomi.png)

### 3. 结果分析
所有数据来自荣耀10和小米mix2的**中差评**, 因为京东翻页限制只能翻到100页, 各自采集了两部手机中评1000,差评1000, 共4000条评论数据,   
想看看大家对手机不满意, 根源在哪里, 都在抱怨什么.  

#### 共性  
可以看到大家在两部手机中,都提到了 **游戏, 屏幕, 电池, 耳机**, 说明大家在买手机时, 对这四点比较看中,是关注的热点,  

#### 再看各自比较突出的关键词,  
小米中比较突出的一个关键词是**降价**,在**2000**条评论中提到了**421**次, 可能是后期降价降多了,老用户心理不平衡了(如果小米价格稳定一点,是不是能适当提高好评率??)  

荣耀中比较突出的关键词是**发热,耗电**,在**2000**条评论中提到了**480**多次, 还有一个是被提及**271**次的**指纹**(在小米中被提及**70**次),指纹解锁也是荣耀号称"吓人的技术"中的一个组成,可在中差评中这么高频的出现, 看来花粉们还是比较买账.  

#### 再看用户情感,  
两边用户情绪都差不多, 但是荣耀用户总体情绪还是高于小米用户, 荣耀用户积极情绪和消极情绪值都大于小米用户, 看来选择荣耀的用户情绪都很激烈啊~~, 小米用户总体都温和一点.  

#### 我自己的看法:  
对比小米和荣耀的词频分析, 我发现小米靠前词频**降价,售后,快递,申请,包装**这些词在荣耀词频中, 词频极低,荣耀中词频靠前的有**指纹,发热,识别,拍照,耗电,续航**这些和手机本身使用配置相关的词, 由此可以推测, 华为的购买体验/售后服务 做的比小米好, 小米用户在抱怨购买体验, 华为用户跳过了购买体验, 专注于体验手机本身的功能和使用感受.  


有意思的是,**荣耀** 在小米评论中出现了 **58** 次, **小米** 在荣耀评论中出现了 **63** 次,  
小米MIX2 和 荣耀10 同配置同价位, 看来还是有人跟我一样在两款手机中反复对比,摇摆不定.  

#### 选择
两款手机都是毁誉参半, 选哪个呢?????  
**我选了,,,,荣耀9**,  
我不是"花粉",但比较恋旧,我手上的老年机就是华为, 跟了我三年, 手机壳都摔碎了三个,后来摔得没有手机壳了,终于把屏摔碎了.....  
而且差评里荣耀的"老花粉"们纷纷一副荣耀10不如荣耀7/9的论调,我比较相信过来人的体验.....  
最重要的一点呢, 荣耀9去年发布的,荣耀10一出来,9马上降到了1900多,在我看来,9也只比10差一点, 运行内存少2G,内核一个4核,一个8核,但参考我的老年机使用体验,9刚好已经达到了我的期望配置, 还省了600多呢(8G的内存条也只要500+)  

对一个月月吃土的人来说, 简直看到了活着的希望 :P


## 八.可视化展现
荣耀10:  
![2018-06-30-gseeker-data-visual-rongyao](/assets/img/blog/2018/2018-06-30-gseeker-data-visual-rongyao.png)

小米mix2:  
![2018-06-30-gseeker-data-visual-xiaomi](/assets/img/blog/2018/2018-06-30-gseeker-data-visual-xiaomi.png)

## 九. 写在后面
最后缅怀一下我的老年机

- [填坑 - 京东评论四个翻页区](https://www.gooseeker.com/doc/forum.php?mod=viewthread&tid=11341&page=1#pid32603)  
- [中关村在线-手机评测网站](http://www.zol.com.cn/)  
- [xml转excel-集搜客转](https://www.gooseeker.com/doc/article-329-1.html)  

卒.
